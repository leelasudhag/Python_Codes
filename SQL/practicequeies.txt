select * from countries;

create or replace view country_view as select * from countries where region = 'chennai';

select * from country_view;

select * from family;
1) Get me the details of second oldest member in the family
2) get me the second oldest member whose occupation is housewife  -- assignment

select * from (select *, dense_rank() over (order by age desc) as rnk from family) a where a.rnk == 2;


select empid, salary, Ispermanent from empsalary;

select empid, Ispermanent, count(Ispermanent) from empsalary group by Ispermanent;

select empid, empname, department, contactno, emailid, empheadid from employee

select a.empid, a.empname, b.salary from employee a inner join empsalary b on a.empid = b.empid;

empnames and the employee head name for each employee

select a.empname, b.empname as emp_head from employee a left join employee b on a.empheadid = b.empid;


1) get the employees who is working in the deplartment E-101
select empname from employee where department = "E-101";
2) get the number of employees for each department
select department , count(department) as numberOfEmployees from employee group by department;
3) get the list of employess who is using  gmail for the email id
select * from employee where emailid like '%gmail.com%';



1) Employee Table
emp_id, emp_name, Emp_salaray

2) Department
Dept_id, dept_name, emp_id

how do we get the top 5 employess per department in the order of salary

select * from (select *, rank() over(partition by dept_id order by salary desc) as rnk from joined_table ) where rnk <= 5;


select * from sales order by user_id desc;